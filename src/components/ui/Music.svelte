<script lang="ts">
	import { era } from "@/stores/era"
	import { onMount } from "svelte"

    let music: HTMLAudioElement;
    let muted = true;
    
    onMount(() => {
        music.volume = 0.2
        music.play()
    })

    const mute = () => {
        muted = !muted;
    }

</script>

<button class="audio-mute" on:click={() => mute()}>
    {#if muted}
    <svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox="0 0 24 24"><path d="M21.488 2.556a.75.75 0 0 0-1.06 0l-1.95 1.95a10 10 0 0 0-10.32-1.66a10 10 0 0 0-6.16 9.22v6.6a3.5 3.5 0 0 0 .51 1.81a.74.74 0 0 0 0 1.06a.709.709 0 0 0 .53.22a.74.74 0 0 0 .53-.22l.52-.52l4.41-4.41l.09-.09l10.49-10.44l2.46-2.46a.75.75 0 0 0-.05-1.06m-13.2 12.14a3.43 3.43 0 0 0-.69-.83a3.47 3.47 0 0 0-4.1-.26v-1.53a8.48 8.48 0 0 1 13.92-6.5zm13.71-2.62v6.6c.005.05.005.1 0 .15a3.38 3.38 0 0 1-3.37 3.08a3.39 3.39 0 0 1-3.39-3.19v-2.64a3.4 3.4 0 0 1 1.06-2.31a3.49 3.49 0 0 1 4.22-.33v-1.36a8.72 8.72 0 0 0-.92-3.88a.75.75 0 0 1 .33-1a.77.77 0 0 1 1 .33a10.19 10.19 0 0 1 1.07 4.55"/></svg>
    {:else}
    <svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox="0 0 20 20"><path d="M10 3a7 7 0 0 0-7 7v1h1.5a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-.5.5H4a2 2 0 0 1-2-2v-6a8 8 0 1 1 16 0v6a2 2 0 0 1-2 2h-.5a.5.5 0 0 1-.5-.5v-6a.5.5 0 0 1 .5-.5H17v-1a7 7 0 0 0-7-7m.5 7.5a.5.5 0 0 0-1 0v7a.5.5 0 0 0 1 0zm-3 1.5a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-1 0v-4a.5.5 0 0 1 .5-.5m5.5.5a.5.5 0 0 0-1 0v4a.5.5 0 0 0 1 0z"/></svg>
    {/if}
</button>

<audio bind:this={music} controls bind:muted={muted} autoplay loop src={`/audio/${$era}.mp3`}></audio>

<style lang="sass">
.audio-mute
    position: fixed
    top: 0
    right: 0
    margin: 2rem
    z-index: 100
    background: var(--text-color)
    border-radius: 50%
    padding: 0.5rem

    &:hover
        background: var(--highlight-color)
    
    path
        fill: var(--background-color)

</style>